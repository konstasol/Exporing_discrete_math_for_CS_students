<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î®Ï‚ Î£Ï…Î½Î´Ï…Î±ÏƒÎ¼ÏÎ½, Î”Î¹Î±Ï„Î¬Î¾ÎµÏ‰Î½ & ÎœÎµÏ„Î±Î¸Î­ÏƒÎµÏ‰Î½</title>
  <style>
    :root {
      --bg: #0f0724;
      --card: #1a0f2a;
      --muted: #b9a8d9;
      --accent1: #8a4bd6; /* Î¹ÏÎ´ÎµÏ‚ */
      --accent2: #6e2fd6; /* Î²Î±Î¸Ï Î¹ÏÎ´ÎµÏ‚ */
      --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.02);
      --success: #9fe6b3;
      --danger: #ff9aa2;
      font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    * { box-sizing: border-box; }
    html, body {
      height: 100%; margin: 0;
      background: linear-gradient(180deg, var(--bg), #140629 60%);
      color: #eee;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .container {
      max-width: 980px;
      margin: 32px auto;
      padding: 28px;
      border-radius: 16px;
      background: linear-gradient(180deg, var(--card), rgba(26,15,42,0.6));
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
      backdrop-filter: blur(6px);
    }
    header {
      display: flex;
      gap: 16px;
      align-items: center;
      margin-bottom: 24px;
    }
    .logo {
      width: 64px;
      height: 64px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 36px;
      user-select: none;
    }
    h1 {
      margin: 0;
      font-size: 24px;
    }
    p.lead {
      color: var(--muted);
      margin: 6px 0 0;
    }
    nav {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
    }
    nav button {
      flex: 1;
      padding: 12px 0;
      border: none;
      border-radius: 12px;
      background: transparent;
      color: var(--muted);
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
      user-select: none;
    }
    nav button.active {
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      color: white;
      box-shadow: 0 6px 18px rgba(110,47,214,0.3);
    }
    .card {
      background: linear-gradient(180deg, var(--glass), var(--glass-2));
      padding: 24px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.03);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    label {
      display: block;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    input[type=number],
    input[type=text],
    select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.04);
      background: transparent;
      color: inherit;
      font-size: 15px;
      font-weight: 500;
      outline-offset: 2px;
      transition: border-color 0.2s;
    }
    input[type=number]:focus,
    input[type=text]:focus,
    select:focus {
      border-color: var(--accent2);
      background: rgba(255,255,255,0.07);
    }
    .flex-row {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }
    .flex-col {
      flex: 1 1 150px;
      min-width: 120px;
    }
    .switch {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 16px;
      user-select: none;
    }
    .switch input[type=checkbox] {
      transform: scale(1.3);
      cursor: pointer;
    }
    button.primary {
      padding: 12px 18px;
      background: var(--accent2);
      border: none;
      border-radius: 14px;
      color: white;
      font-weight: 700;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
      user-select: none;
    }
    button.primary:hover {
      background: var(--accent1);
    }
    button.ghost {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.06);
      color: var(--muted);
      font-weight: 600;
      cursor: pointer;
      user-select: none;
      padding: 10px 14px;
      border-radius: 12px;
      transition: background 0.3s, color 0.3s;
    }
    button.ghost:hover {
      background: rgba(255,255,255,0.05);
      color: white;
    }
    .formula {
      background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding: 12px;
      border-radius: 12px;
      margin-top: 14px;
      color: var(--muted);
      font-size: 15px;
      font-family: monospace;
      user-select: text;
      min-height: 44px;
    }
    .result {
      margin-top: 12px;
      padding: 14px;
      border-radius: 12px;
      background: rgba(0,0,0,0.25);
      font-family: monospace;
      font-size: 18px;
      font-weight: 700;
      user-select: text;
      min-height: 48px;
    }
    .error {
      color: var(--danger);
      margin-bottom: 16px;
      font-weight: 600;
    }
    .similar-groups-container {
      margin-top: 16px;
      display: none;
    }
    .note {
      font-size: 13px;
      color: var(--muted);
      margin-top: 18px;
      line-height: 1.3;
    }
    footer {
      margin-top: 24px;
      color: var(--muted);
      font-size: 13px;
      text-align: center;
      user-select: none;
    }
    @media (max-width: 720px) {
      .flex-row {
        flex-direction: column;
      }
      nav button {
        font-size: 14px;
        padding: 10px 0;
      }
    }
  </style>
</head>
<body>
  <div class="container" role="main" aria-label="Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î®Ï‚ Î£Ï…Î½Î´Ï…Î±ÏƒÎ¼ÏÎ½, Î”Î¹Î±Ï„Î¬Î¾ÎµÏ‰Î½ ÎºÎ±Î¹ ÎœÎµÏ„Î±Î¸Î­ÏƒÎµÏ‰Î½">
    <header>
      <div class="logo" aria-hidden="true">C</div>
      <div>
        <h1>Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î®Ï‚ Î£Ï…Î½Î´Ï…Î±ÏƒÎ¼ÏÎ½, Î”Î¹Î±Ï„Î¬Î¾ÎµÏ‰Î½ & ÎœÎµÏ„Î±Î¸Î­ÏƒÎµÏ‰Î½</h1>
        <p class="lead">Î•Ï€Î­Î»ÎµÎ¾Îµ Ï„ÏÏ€Î¿, Î±Î½ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Î¹ ÎµÏ€Î±Î½Î±Î»Î®ÏˆÎµÎ¹Ï‚ ÎºÎ±Î¹ Î´ÎµÏ‚ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Î¼Î±Î¶Î¯ Î¼Îµ Ï„Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±.</p>
      </div>
    </header>

    <nav role="tablist" aria-label="Î•Ï€Î¹Î»Î¿Î³Î® Ï„ÏÏ€Î¿Ï… Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï">
      <button id="tab-combination" class="active" role="tab" aria-selected="true" aria-controls="panel-combination" tabindex="0">Î£Ï…Î½Î´Ï…Î±ÏƒÎ¼Î¿Î¯</button>
      <button id="tab-arrangement" role="tab" aria-selected="false" aria-controls="panel-arrangement" tabindex="-1">Î”Î¹Î±Ï„Î¬Î¾ÎµÎ¹Ï‚</button>
      <button id="tab-permutation" role="tab" aria-selected="false" aria-controls="panel-permutation" tabindex="-1">ÎœÎµÏ„Î±Î¸Î­ÏƒÎµÎ¹Ï‚</button>
    </nav>

    <section id="panel-combination" role="tabpanel" aria-labelledby="tab-combination" tabindex="0" class="card" style="display:block;">
      <div class="flex-row">
        <div class="flex-col">
          <label for="comb-n">n (ÏƒÏÎ½Î¿Î»Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½)</label>
          <input type="number" id="comb-n" min="0" value="5" aria-describedby="comb-n-desc" />
          <div id="comb-n-desc" class="note">Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î¿ ÏƒÏÎ½Î¿Î»Î¿</div>
        </div>
        <div class="flex-col">
          <label for="comb-k">k (ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚)</label>
          <input type="number" id="comb-k" min="0" value="3" aria-describedby="comb-k-desc" />
          <div id="comb-k-desc" class="note">Î ÏŒÏƒÎ± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÎµÏ€Î¹Î»Î­Î³Î¿Ï…Î¼Îµ</div>
        </div>
      </div>

      <div class="switch">
        <input type="checkbox" id="comb-repetition" />
        <label for="comb-repetition">Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ· ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹</label>
      </div>
    </section>

    <section id="panel-arrangement" role="tabpanel" aria-labelledby="tab-arrangement" tabindex="0" class="card" style="display:none;">
      <div class="flex-row">
        <div class="flex-col">
          <label for="arr-n">n (ÏƒÏÎ½Î¿Î»Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½)</label>
          <input type="number" id="arr-n" min="0" value="5" aria-describedby="arr-n-desc" />
          <div id="arr-n-desc" class="note">Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î¿ ÏƒÏÎ½Î¿Î»Î¿</div>
        </div>
        <div class="flex-col">
          <label for="arr-k">k (ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚)</label>
          <input type="number" id="arr-k" min="0" value="3" aria-describedby="arr-k-desc" />
          <div id="arr-k-desc" class="note">Î ÏŒÏƒÎ± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î´Î¹Î±Ï„Î¬Î¶Î¿Ï…Î¼Îµ</div>
        </div>
      </div>

      <div class="switch">
        <input type="checkbox" id="arr-repetition" />
        <label for="arr-repetition">Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ· ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹</label>
      </div>
    </section>

    <section id="panel-permutation" role="tabpanel" aria-labelledby="tab-permutation" tabindex="0" class="card" style="display:none;">
      <div class="flex-row" style="align-items:center;">
        <div class="flex-col" style="flex: 1;">
          <label for="perm-n">n (ÏƒÏÎ½Î¿Î»Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½)</label>
          <input type="number" id="perm-n" min="0" value="5" aria-describedby="perm-n-desc" />
          <div id="perm-n-desc" class="note">Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î¿ ÏƒÏÎ½Î¿Î»Î¿</div>
        </div>
        <div class="flex-col" style="flex: none; min-width: 180px;">
          <fieldset>
            <legend style="color: var(--muted); font-size: 13px; margin-bottom: 6px;">Î•Î¯Î´Î¿Ï‚ Î¼ÎµÏ„Î±Î¸Î­ÏƒÎµÏ‰Î½</legend>
            <label><input type="radio" name="perm-type" value="different" checked /> ÎœÎµÏ„Î±Î¸Î­ÏƒÎµÎ¹Ï‚ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏÎ½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½</label><br/>
            <label><input type="radio" name="perm-type" value="similar" /> ÎœÎµÏ„Î±Î¸Î­ÏƒÎµÎ¹Ï‚ Î¿Î¼Î¿Î¯Ï‰Î½ Î¿Î¼Î¬Î´Ï‰Î½</label>
          </fieldset>
        </div>
      </div>

      <div class="similar-groups-container" id="similar-groups-container">
        <label for="similar-groups-input">ÎœÎ­Î³ÎµÎ¸Î¿Ï‚ Î¿Î¼Î¿Î¯Ï‰Î½ Î¿Î¼Î¬Î´Ï‰Î½ (Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÎ¼Î­Î½Î± Î¼Îµ ÎºÏŒÎ¼Î¼Î±)</label>
        <input type="text" id="similar-groups-input" placeholder="Ï€Ï‡ 3,2,2" aria-describedby="similar-groups-desc" />
        <div id="similar-groups-desc" class="note">Î .Ï‡. 3 ÎºÏŒÎºÎºÎ¹Î½Î±, 2 Ï€ÏÎ¬ÏƒÎ¹Î½Î±, 2 Î¼Ï€Î»Îµ (Î¬Î¸ÏÎ¿Î¹ÏƒÎ¼Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¹ÏƒÎ¿ÏÏ„Î±Î¹ Î¼Îµ n)</div>
      </div>
    </section>

    <div style="margin-top: 24px; display: flex; gap: 16px; flex-wrap: wrap;">
      <button class="primary" id="calculate-btn" aria-live="polite" aria-label="Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚">Î¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸÎ£</button>
      <button class="ghost" id="clear-btn" aria-label="ÎšÎ±Î¸Î¬ÏÎ¹ÏƒÎ¼Î± Ï€ÎµÎ´Î¯Ï‰Î½">ÎšÎ±Î¸Î¬ÏÎ¹ÏƒÎ¼Î±</button>
      <button class="ghost" id="copy-btn" aria-label="Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î¿Ï‚">Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î¿Ï‚</button>
    </div>

    <div class="formula" aria-live="polite" id="formula">Î¤ÏÏ€Î¿Ï‚: â€”</div>
    <div class="result" aria-live="polite" id="result">Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: â€”</div>
    <div class="error" role="alert" id="error"></div>

    <footer> ğŸ’œ</footer>
  </div>

<script>
  // BigInt factorial
  function factorialBig(n) {
    n = BigInt(n);
    if (n < 0n) throw 'Î¤Î¿ n Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Î±ÎºÎ­ÏÎ±Î¹Î¿Ï‚.';
    let res = 1n;
    for (let i = 2n; i <= n; i++) res *= i;
    return res;
  }

  // Permutations nPr = n!/(n-k)!
  function nPr(n, k) {
    n = BigInt(n);
    k = BigInt(k);
    if (k > n) return 0n;
    return factorialBig(n) / factorialBig(n - k);
  }

  // Î£Ï…Î½Î´Ï…Î±ÏƒÎ¼Î¿Î¯ ==> n!/(k!*(n-k)!)
  function nCr(n, k) {
    n = BigInt(n);
    k = BigInt(k);
    if (k > n) return 0n;
    if (k > n - k) k = n - k;
    let numerator = 1n;
    let denominator = 1n;
    for (let i = 1n; i <= k; i++) {
      numerator *= (n - k + i);
      denominator *= i;
    }
    return numerator / denominator;
  }

  // Format BigInt with commas
  function formatBigInt(num) {
    let s = num.toString();
    let neg = s.startsWith('-');
    if (neg) s = s.slice(1);
    let out = '';
    for (let i = 0; i < s.length; i++) {
      let pos = s.length - i;
      out = s[pos - 1] + out;
      if ((i + 1) % 3 === 0 && pos - 1 > 0) out = ',' + out;
    }
    return (neg ? '-' : '') + out;
  }

  // DOM tabs
  const tabs = {
    combination: document.getElementById('tab-combination'),
    arrangement: document.getElementById('tab-arrangement'),
    permutation: document.getElementById('tab-permutation'),
  };
  const panels = {
    combination: document.getElementById('panel-combination'),
    arrangement: document.getElementById('panel-arrangement'),
    permutation: document.getElementById('panel-permutation'),
  };

  // Inputs
  const combNInput = document.getElementById('comb-n');
  const combKInput = document.getElementById('comb-k');
  const combRepetitionCheckbox = document.getElementById('comb-repetition');

  // Inputs arrangement
  const arrNInput = document.getElementById('arr-n');
  const arrKInput = document.getElementById('arr-k');
  const arrRepetitionCheckbox = document.getElementById('arr-repetition');

  // Inputs
  const permNInput = document.getElementById('perm-n');
  const permTypeRadios = document.querySelectorAll('input[name="perm-type"]');
  const similarGroupsContainer = document.getElementById('similar-groups-container');
  const similarGroupsInput = document.getElementById('similar-groups-input');

  // Buttons +outputs
  const calculateBtn = document.getElementById('calculate-btn');
  const clearBtn = document.getElementById('clear-btn');
  const copyBtn = document.getElementById('copy-btn');
  const formulaEl = document.getElementById('formula');
  const resultEl = document.getElementById('result');
  const errorEl = document.getElementById('error');

  let currentTab = 'combination';

  // Switch tabs
  function switchTab(newTab) {
    if (newTab === currentTab) return;
    // update active tab button
    Object.keys(tabs).forEach(key => {
      const isActive = (key === newTab);
      tabs[key].classList.toggle('active', isActive);
      tabs[key].setAttribute('aria-selected', isActive);
      tabs[key].setAttribute('tabindex', isActive ? '0' : '-1');
      panels[key].style.display = isActive ? 'block' : 'none';
    });
    currentTab = newTab;
    updateUI();
    clearOutput();
  }

  Object.entries(tabs).forEach(([key, btn]) => {
    btn.addEventListener('click', () => switchTab(key));
  });

  // Toggle visibility
  function updatePermutationTypeUI() {
    const selected = document.querySelector('input[name="perm-type"]:checked').value;
    if (selected === 'similar') {
      similarGroupsContainer.style.display = 'block';
    } else {
      similarGroupsContainer.style.display = 'none';
      similarGroupsInput.value = '';
    }
    clearOutput();
  }
  permTypeRadios.forEach(radio => {
    radio.addEventListener('change', updatePermutationTypeUI);
  });

  // Enable/disable repetition checkbox
  function updateUI() {
    errorEl.textContent = '';
    formulaEl.textContent = 'Î¤ÏÏ€Î¿Ï‚: â€”';
    resultEl.textContent = 'Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: â€”';

    if(currentTab === 'combination') {
      combRepetitionCheckbox.disabled = false;
    } else if(currentTab === 'arrangement') {
      arrRepetitionCheckbox.disabled = false;
    } else if(currentTab === 'permutation') {
      // disable repetition checkbox
      // reset repetition checkboxes
      combRepetitionCheckbox.checked = false;
      arrRepetitionCheckbox.checked = false;
      similarGroupsContainer.style.display = (document.querySelector('input[name="perm-type"]:checked').value === 'similar') ? 'block' : 'none';
    }
  }

  // Clear formula, result, error
  function clearOutput() {
    formulaEl.textContent = 'Î¤ÏÏ€Î¿Ï‚: â€”';
    resultEl.textContent = 'Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: â€”';
    errorEl.textContent = '';
  }

  function compute() {
    errorEl.textContent = '';
    formulaEl.textContent = 'Î¤ÏÏ€Î¿Ï‚: â€”';
    resultEl.textContent = 'Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: â€”';

    try {
      if(currentTab === 'combination') {
        const n = Number(combNInput.value);
        const k = Number(combKInput.value);
        const repetition = combRepetitionCheckbox.checked;

        if(!Number.isInteger(n) || n < 0) throw 'Î¤Î¿ n Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Î±ÎºÎ­ÏÎ±Î¹Î¿Ï‚.';
        if(!Number.isInteger(k) || k < 0) throw 'Î¤Î¿ k Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Î±ÎºÎ­ÏÎ±Î¹Î¿Ï‚.';

        let formula = '';
        let result = 0n;

        if(repetition) {
          formula = `C(n+k-1, k) = C(${n + k -1}, ${k})`;
          result = nCr(n + k - 1, k);
        } else {
          if(k > n) {
            formula = `C(n,k) = 0 (k > n)`;
            result = 0n;
          } else {
            formula = `C(n,k) = n! / (k! (n-k)!) = C(${n}, ${k})`;
            result = nCr(n, k);
          }
        }
        formulaEl.textContent = 'Î¤ÏÏ€Î¿Ï‚: ' + formula;
        resultEl.textContent = 'Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: ' + formatBigInt(result);
      }
      else if(currentTab === 'arrangement') {
        const n = Number(arrNInput.value);
        const k = Number(arrKInput.value);
        const repetition = arrRepetitionCheckbox.checked;

        if(!Number.isInteger(n) || n < 0) throw 'Î¤Î¿ n Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Î±ÎºÎ­ÏÎ±Î¹Î¿Ï‚.';
        if(!Number.isInteger(k) || k < 0) throw 'Î¤Î¿ k Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Î±ÎºÎ­ÏÎ±Î¹Î¿Ï‚.';

        let formula = '';
        let result = 0n;

        if(repetition) {
          formula = `A(n,k) Î¼Îµ ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ· = n^k = ${n}^${k}`;
          result = BigInt(n) ** BigInt(k);
        } else {
          if(k > n) {
            formula = `A(n,k) = 0 (k > n)`;
            result = 0n;
          } else {
            formula = `A(n,k) = n! / (n-k)! = A(${n}, ${k})`;
            result = nPr(n, k);
          }
        }
        formulaEl.textContent = 'Î¤ÏÏ€Î¿Ï‚: ' + formula;
        resultEl.textContent = 'Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: ' + formatBigInt(result);
      }
      else if(currentTab === 'permutation') {
        const n = Number(permNInput.value);
        if(!Number.isInteger(n) || n < 0) throw 'Î¤Î¿ n Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Î±ÎºÎ­ÏÎ±Î¹Î¿Ï‚.';
        const permType = document.querySelector('input[name="perm-type"]:checked').value;

        let formula = '';
        let result = 0n;

        if(permType === 'different') {
          formula = `P(n) = n! = ${n}!`;
          result = factorialBig(n);
        } else {
          const groupsStr = similarGroupsInput.value.trim();
          if(groupsStr === '') throw 'Î“ÏÎ¬ÏˆÎµ Ï„Î¹Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ ÏŒÎ¼Î¿Î¹Ï‰Î½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ Ï€Ï‡ 3,2,2';
          let groups = groupsStr.split(',').map(x => x.trim()).filter(x => x !== '').map(Number);
          if(groups.some(g => !Number.isInteger(g) || g < 0)) throw 'ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î¿Î¼Î¬Î´ÎµÏ‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÎ¿Î¯ Î±ÎºÎ­ÏÎ±Î¹Î¿Î¹.';
          const sumGroups = groups.reduce((a,b) => a+b, 0);
          if(sumGroups !== n) throw 'Î¤Î¿ Î¬Î¸ÏÎ¿Î¹ÏƒÎ¼Î± Ï„Ï‰Î½ Î¿Î¼Î¬Î´Ï‰Î½ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ¿ Î¼Îµ Ï„Î¿ n.';
          let denom = 1n;
          for(let g of groups) denom *= factorialBig(g);
          formula = `P(n) = n! / (qâ‚! qâ‚‚! ... ) = ${n}! / (${groups.map(x => x + "!").join(" Ã— ")})`;
          result = factorialBig(n) / denom;
        }
        formulaEl.textContent = 'Î¤ÏÏ€Î¿Ï‚: ' + formula;
        resultEl.textContent = 'Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: ' + formatBigInt(result);
      }
    } catch(e) {
      errorEl.textContent = e;
    }
  }

  calculateBtn.addEventListener('click', compute);
  clearBtn.addEventListener('click', () => {
    combNInput.value = '5';
    combKInput.value = '3';
    combRepetitionCheckbox.checked = false;
    arrNInput.value = '5';
    arrKInput.value = '3';
    arrRepetitionCheckbox.checked = false;
    permNInput.value = '5';
    permTypeRadios.forEach(r => r.checked = r.value === 'different');
    similarGroupsInput.value = '';
    updatePermutationTypeUI();
    clearOutput();
  });
  copyBtn.addEventListener('click', () => {
    if(resultEl.textContent === 'Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: â€”') return;
    navigator.clipboard.writeText(resultEl.textContent.replace('Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±: ', '')).then(() => {
      alert('Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ Ï„Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±!');
    }, () => {
      alert('Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î®Ï‚.');
    });
  });

  // Initialize UI
  updateUI();
  updatePermutationTypeUI();
</script>
</body>
</html>
